{% extends 'layout.html' %}

{% block body %}
<h1> Propose scrim: </h1>
<form action="" method="post"  name="propose_scrim">
	{{form.hidden_tag()}}
	<table>
		<tr>
			<td>Your team: {{ form.team() }}</td>
		</tr>
		<tr>
			<td>Your team timezone: {{ form.time_zone() }}</td>
		</tr>
		<tr>
			<td>Opponent Day (UTC): {{ form.day() }}</td>
		</tr>
		<tr>
			<td>Opponent Start Time (UTC): {{ form.start_time() }}</td>
			<td>Your Start Time: <span class="your_start_time"></span></td>
		</tr>
		<tr>
			<td>Map: {{ form.map() }}</td>
		</tr>
		<tr>
			<td>Type: {{ form.type() }}</td>
		</tr>
	</table>
	<input type="submit" value="Propose Scrim">
</form>

<script src="/static/js/moment.min.js"></script>
<script src="/static/js/moment-timezone.min.js"></script>
<script src="/static/js/moment-timezone-data.js"></script>
<script>
  $(document).ready(function(){
	var opponentDay = $('#day');
	var opponentTime = $('#start_time');
	var yourTimeZone = $('#time_zone')
	var yourTime = $('.your_start_time');

	var updateYourTime = function() {
		timezone = yourTimeZone.val();
		day = opponentDay.val();
		hour = opponentTime.val();

		thisWeek = moment.utc().day(parseInt(day)).hour(hour).tz(timezone)
		nextWeek = moment.utc().day(parseInt(day)+7).hour(hour).tz(timezone)

		if (thisWeek.unix() < moment.utc().tz(timezone).unix()) {
			yourTime.html(nextWeek.minute(0).format('LLLL'));
		} else {
			yourTime.html(thisWeek.minute(0).format('LLLL'));
		}
	}
	
	updateYourTime();
	opponentDay.change(updateYourTime);
	opponentTime.change(updateYourTime);
	yourTimeZone.change(updateYourTime);
  });
</script>
{% endblock %}